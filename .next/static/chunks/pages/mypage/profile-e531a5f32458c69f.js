(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{8516:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mypage/profile",function(){return n(5606)}])},2214:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var i=n(5893),l=n(9008),s=n.n(l),r=n(1734),a=n(1163),o=n(7294),c=n(5655);let d=()=>{let e=(0,a.useRouter)(),t=(0,o.useCallback)(t=>e.push("function"==typeof t?t(c.V):t),[e]),n=(0,o.useCallback)(t=>e.replace("function"==typeof t?t(c.V):t),[e]);return{push:t,replace:n}};var u=n(3717),h=n(1136);let f=e=>{let{caption:t="Loading..."}=e;return(0,i.jsxs)(u.k,{flexDirection:"column",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",gap:"10px",position:"fixed",left:"0",top:"0","z-index":"1000",background:"#AAA3",children:[(0,i.jsx)(h.$,{size:"xl",className:"mt-8",color:"blue.500",emptyColor:"gray.200",speed:"1.0s"}),(0,i.jsx)("span",{children:t})]})},x=e=>{let{children:t}=e,{user:n}=(0,r.E)(),{push:l}=d();return void 0===n?(0,i.jsx)(f,{caption:"ユーザー情報を取得中…"}):null===n?(l(e=>e.signin.$url()),null):(0,i.jsx)(i.Fragment,{children:t})},m=e=>{let{title:t,children:n,isSetUpOGP:l=!0,isTitleHidden:r=!1,isAuthPageHidden:a=!1,loading:c=!1,isLimitWidth:d=!0}=e,[u,h]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{let e=()=>h(!0),t=()=>h(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),(0,i.jsxs)(i.Fragment,{children:[l&&(0,i.jsxs)(s(),{children:[(0,i.jsx)("title",{children:t}),(0,i.jsx)("meta",{property:"og:title",content:t})]}),!u&&(0,i.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,i.jsx)(f,{caption:""}),(0,i.jsx)("p",{className:"text-white text-center mt-32",children:"インターネット接続が不安定です。"})]}),(0,i.jsxs)("div",{className:"".concat(d?"md:px-[15vw] px-[5vw]":""," flex  flex-col items-center  h-full overflow-x-hidden w-screen\n        "),children:[!r&&(0,i.jsx)("h1",{className:"text-2xl my-6 font-bold w-[100vw] text-center",children:t}),c?(0,i.jsx)(f,{caption:"読込中…"}):a?(0,i.jsx)(x,{children:n}):n]})]})};var p=m},1586:function(e,t,n){"use strict";n.d(t,{s:function(){return r}});var i=n(7294),l=n(19),s=n(9828);let r=e=>{let[t,n]=(0,i.useState)(null),[r,a]=(0,i.useState)(!0),[o,c]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!e){a(!1);return}let t=(0,l.ad)(),i=(0,l.JU)(t,"users",e),r=(0,s.cf)(i,e=>{e.exists()?n({...e.data(),id:e.id}):n(null),a(!1)},e=>{c(e),a(!1)});return()=>r()},[e]),{user:t,loading:r,error:o}}},6285:function(e,t,n){"use strict";n.d(t,{g:function(){return l}});var i=n(7963);let l=()=>{let e=(0,i.p)();return(t,n,i)=>{e({title:n,description:i,status:t,duration:5e3,isClosable:!0,position:"top"})}}},5655:function(e,t,n){"use strict";n.d(t,{V:function(){return i}});let i={lp:{$url:e=>({pathname:"/lp",hash:null==e?void 0:e.hash})},mypage:{profile:{$url:e=>({pathname:"/mypage/profile",hash:null==e?void 0:e.hash})}},signin:{$url:e=>({pathname:"/signin",hash:null==e?void 0:e.hash})},$url:e=>({pathname:"/",hash:null==e?void 0:e.hash})}},5606:function(e,t,n){"use strict";n.r(t),n.d(t,{ProfilePage:function(){return W},default:function(){return H}});var i=n(5893),l=n(4023),s=n(1734),r=n(1586),a=n(2214);let o={id:"ID",name:"名前",email:"メールアドレス",iconImageUrl:"アイコン画像",description:"説明",includePaymentMethodInOrder:"注文情報に決済方法を含める",paymentMethods:"決済方法",isSetUpWaitingCardLimit:"待ち札の番号を設定する",waitingCardLimit:"待ち札番号の上限",createdTime:"作成日",updatedTime:"更新日"};var c=n(7294),d=n(9603),u=n(9417);let h=e=>e?e.split("\n").map((e,t)=>(0,i.jsxs)(c.Fragment,{children:[e,(0,i.jsx)("br",{})]},t)):null;var f=n(3090),x=n(7169),m=n(6180),p=n(5541),g=n(9778),v=n(3597),b=n(4859),j=n(6205),w=n(4346),y=n(5970),k=n(5418),N=n(4253),C=n(4225),S=n(6650),E=n(3966),I=n(9828);let _=()=>{let e=(0,c.useCallback)(async(e,t,n,i)=>{let l=(0,I.ad)(),s=(0,I.JU)(l,e,t);await (0,I.r7)(s,{[n]:i,updatedTime:new Date})},[]);return e};var U=n(6285),L=n(5675),D=n.n(L),P=n(878),T=n(19);let V=()=>{let[e,t]=(0,c.useState)([]),[n,i]=(0,c.useState)(!0),[l,s]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let e=async()=>{try{let e=(0,T.ad)(),n=await (0,T.PL)((0,T.hJ)(e,"tags")),l=n.docs.map(e=>({...e.data(),id:e.id}));t(l)}catch(r){s(r)}finally{i(!1)}};e()},[]),{tags:e,loading:n,error:l}},O=e=>{let{formValue:t="",setFormValue:n=()=>{},currentValue:l=""}=e;return(0,i.jsx)(f.I,{value:t,onChange:e=>n(e.target.value),placeholder:l})},z=e=>{let{formValue:t="",setFormValue:n=()=>{},currentValue:l=""}=e;return(0,i.jsx)(x.g,{value:t,onChange:e=>n(e.target.value),placeholder:l})},F=e=>{let{previewUrl:t,handleImageUpload:n}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.I,{type:"file",onChange:n,size:"sm"}),t&&(0,i.jsx)("div",{style:{width:"100%",marginTop:"10px"},children:(0,i.jsx)(D(),{src:t,alt:"プレビュー画像",width:500,height:300})})]})},A=e=>{let{formValue:t="",setFormValue:n=()=>{},selectOptions:l=[]}=e;return(0,i.jsx)("select",{value:t,onChange:e=>n(e.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px"},children:l.map(e=>(0,i.jsx)("option",{value:e.value,children:e.value},e.key))})},$=e=>{var t;let{formValue:n,setFormValue:l=()=>{}}=e,s=6e4*new Date().getTimezoneOffset();return(0,i.jsx)(f.I,{type:"datetime-local",value:n instanceof I.EK?(t=n.toDate(),new Date(t.getTime()-s).toISOString().slice(0,16)):"",onChange:e=>l(I.EK.fromDate(new Date(e.target.valueAsNumber+s)))})},R=e=>{let{formValue:t=!1,setFormValue:n=()=>{}}=e;return(0,i.jsx)(m.X,{isChecked:t,onChange:e=>n(e.target.checked)})},J=e=>{let{formValue:t=[],setFormValue:n=()=>{},selectOptions:l=[]}=e;return(0,i.jsx)(P.default,{options:l,displayValue:"value",onSelect:e=>n(e.map(e=>e.key)),selectedValues:l.filter(e=>t.includes(e.key))})},M=e=>{let{isOpen:t,onClose:n,documentId:l,updateField:s,collectionName:r,label:a,inputType:o="text",onUpdated:d,currentValue:u}=e,[h,f]=(0,c.useState)(u);(0,c.useEffect)(()=>{f(u)},[s,u]);let{storage:x}=(0,E.e)(),m=(0,U.g)(),I=_(),{tags:L}=V(),D=L.map(e=>({key:e.id,value:e.title})),P=async()=>{try{await I(r,l,s,h),n(),m("success","更新が完了しました","".concat(a,"を更新しました")),d&&d()}catch(e){console.error(e),m("error","エラーが発生しました","更新に失敗しました")}},[T,M]=(0,c.useState)(null),W=async e=>{if(K(!0),!e.target.files||0===e.target.files.length){K(!1);return}let t=e.target.files[0];if(!t){K(!1);return}let n=new FileReader;n.onload=()=>{M(n.result)},n.readAsDataURL(t);let i=(0,S.iH)(x,"images/".concat(r,"/").concat(s,"/").concat(l,"/").concat(t.name));try{await (0,S.KV)(i,t);let a=await (0,S.Jt)(i);f(a)}catch(o){console.error("Upload failed:",o)}K(!1)},[H,K]=(0,c.useState)(!1);return(0,i.jsxs)(p.u_,{isOpen:t,onClose:n,children:[(0,i.jsx)(g.Z,{}),(0,i.jsxs)(v.h,{maxW:"90vw",children:[(0,i.jsx)(b.x,{children:"編集"}),(0,i.jsx)(j.o,{}),(0,i.jsx)(w.f,{pb:6,children:(0,i.jsxs)(y.NI,{children:[(0,i.jsx)(k.l,{children:a}),t&&(0,i.jsx)({text:O,textarea:z,file:F,select:A,timestamp:$,checkbox:R,tags:J}[o],{formValue:h,setFormValue:f,currentValue:u,selectOptions:D,handleImageUpload:W,previewUrl:T})]})}),(0,i.jsxs)(N.m,{children:[(0,i.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-3 disabled:bg-blue-300",onClick:P,disabled:""===h||h===u||H,children:"保存"}),(0,i.jsx)(C.z,{onClick:()=>{n(),f(void 0)},children:"キャンセル"})]})]})]})},W=()=>{let{user:e}=(0,s.E)(),{user:t,loading:n}=(0,r.s)(null==e?void 0:e.uid),[f,x]=(0,c.useState)(!1),m=()=>x(!0),p=()=>x(!1),[g,v]=(0,c.useState)("name"),[b,j]=(0,c.useState)(!1),w=e=>{let{property:t}=e;return(0,i.jsx)("button",{onClick:()=>{v(t),m()},className:"flex items-center justify-center w-4 h-4 ".concat(b?"block":"hidden"),children:(0,i.jsx)(d.G,{icon:u.IwR,size:"sm",width:"12",height:"12"})})};return(0,i.jsxs)(a.Z,{title:"設定",isAuthPageHidden:!0,loading:n,isLimitWidth:!1,isTitleHidden:!0,children:[(0,i.jsx)("div",{className:"w-full flex items-center justify-center",children:(0,i.jsxs)("div",{className:"bg-white w-full max-w-md overflow-hidden",children:[(0,i.jsx)("div",{className:"relative h-44 bg-[#ea5514] flex items-start justify-center",children:(0,i.jsxs)("div",{className:"absolute -bottom-12 bg-white rounded-full w-24 h-24 border-4 border-gray-900 flex items-center justify-center text-6xl",children:[(0,i.jsx)(l.q,{flexShrink:0,width:24,height:24,src:(null==t?void 0:t.iconImageUrl)||"default_image_url",className:"absolute"}),(0,i.jsx)("div",{className:"absolute bottom-0 right-1",children:(0,i.jsx)(w,{property:"iconImageUrl"})})]})}),(0,i.jsxs)("div",{className:"pt-16 pb-6 px-10 text-center",children:[(0,i.jsxs)("h2",{className:"text-2xl font-bold mb-1 gap-2 flex items-center justify-center",children:[null==t?void 0:t.name,(0,i.jsx)(w,{property:"name"})]}),(0,i.jsx)("p",{className:"text-gray-500 mb-4",children:"Software Engineer"}),(0,i.jsxs)("p",{className:"w-full text-center text-gray-700 mb-6 flex items-end justify-center flex-col",children:[h(null==t?void 0:t.description),(0,i.jsx)(w,{property:"description"})]}),(0,i.jsxs)("div",{className:"flex justify-center gap-4 mt-20 mb-6",children:[(0,i.jsx)("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 w-full rounded-2xl",onClick:()=>{j(!b)},children:b?"Done":"Edit Profile"}),(0,i.jsx)("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 w-full rounded-2xl",children:"Share Profile"})]})]})]})}),(0,i.jsx)(M,{isOpen:f,onClose:p,documentId:(null==e?void 0:e.uid)||"",updateField:g,collectionName:"users",label:o[g],inputType:"description"===g?"textarea":"iconImageUrl"===g?"file":"includePaymentMethodInOrder"===g||"isSetUpWaitingCardLimit"===g?"checkbox":"text",currentValue:"paymentMethods"===g?"":null==t?void 0:t[g]})]})};var H=W}},function(e){e.O(0,[16,976,210,79,774,888,179],function(){return e(e.s=8516)}),_N_E=e.O()}]);